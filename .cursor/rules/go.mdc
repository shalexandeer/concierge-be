---
alwaysApply: true
---

## ğŸ—ƒï¸ Database Conventions

### Multi-Tenancy
- Every tenant-scoped table must include a `tenant_id` column of type `UUID`.
- Global tables (e.g., `tenants`, `users`) do not contain `tenant_id`.

### Table Naming
- Use plural and snake_case:
  - âœ… `user_tenants`
  - âœ… `payment_methods`
  - âŒ `UserTenant`, `paymentMethod`

### Primary Keys
- All tables use UUID as the primary key (`id UUID PRIMARY KEY`).

### Foreign Keys & Relationships
- Foreign key columns follow the pattern: `{table_name}_id` (singular table name + `_id`).
  - Example in `user_tenants`:
    - `user_id` â†’ references `users(id)`
    - `tenant_id` â†’ references `tenants(id)`

### Core Multi-Tenant Tables
| Table           | Purpose |
|-----------------|--------|
| `tenants`       | Stores tenant metadata |
| `users`         | Global user accounts (not tenant-scoped) |
| `user_tenants`  | Many-to-many join: links users to tenants (includes `user_id`, `tenant_id`) |

### JSON Field Naming (API Layer)
- Use camelCase for all JSON keys in requests/responses:
  ```json
  {
    "id": "a1b2c3...",
    "tenantId": "x9y8z7...",
    "email": "user@example.com",
    "createdAt": "2024-01-01T00:00:00Z"
  }

### Project Structure
.
â”œâ”€â”€ cmd/
â”‚   â””â”€â”€ app/                 # Main entrypoint (`main.go`)
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ users/               # Bounded context: user domain
â”‚   â”œâ”€â”€ tenants/             # Bounded context: tenant domain
â”‚   â””â”€â”€ pkg/                 # Shared internal utilities (optional)
â””â”€â”€ pkg/                     # Public, reusable packages (rarely used)

internal/users/
â”œâ”€â”€ model.go        # Domain models (with JSON tags)
â”œâ”€â”€ repository.go   # Data access layer (DB queries)
â”œâ”€â”€ service.go      # Business logic
â””â”€â”€ handler.go      # HTTP request/response handlers
---
